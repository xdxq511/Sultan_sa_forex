//@version=5
strategy("VIP 1M Signals (RSI)", overlay=true, calc_on_every_tick=true, pyramiding=0)

len = input.int(14, "RSI Length")
ob  = input.int(70, "Overbought")
os  = input.int(30, "Oversold")
r   = ta.rsi(close, len)

longSig  = ta.crossover(r, os)    // CALL
shortSig = ta.crossunder(r, ob)   // PUT

plotshape(longSig,  title="CALL", style=shape.triangleup,   location=location.belowbar, size=size.tiny, text="CALL")
plotshape(shortSig, title="PUT",  style=shape.triangledown, location=location.abovebar, size=size.tiny, text="PUT")

pair = syminfo.ticker
tf   = timeframe.period
ts   = timenow

alert_msg_call = str.format('{{"token":"{0}", "pair":"{1}", "tf":"{2}", "side":"CALL", "ts":{3}, "price":{4}}}', "SECRET_TOKEN", pair, tf, ts, close)
alert_msg_put  = str.format('{{"token":"{0}", "pair":"{1}", "tf":"{2}", "side":"PUT",  "ts":{3}, "price":{4}}}', "SECRET_TOKEN", pair, tf, ts, close)

alertcondition(longSig, title="CALL alert", message=alert_msg_call)
alertcondition(shortSig, title="PUT alert",  message=alert_msg_put)
